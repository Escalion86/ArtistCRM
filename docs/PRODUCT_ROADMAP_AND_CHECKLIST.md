# Product Roadmap And Checklist

## Как пользоваться
- Этот файл — единый рабочий план по развитию ArtistCRM.
- Обновляем статусы задач прямо здесь:
  - `[ ]` не начато
  - `[-]` в работе
  - `[x]` выполнено
- После каждого релиза обновляем:
  - блок `Прогресс по спринтам`
  - блок `Выполнено`
  - блок `Следующие шаги`

---

## Цели продукта (текущий фокус)
- Не терять заявки и не забывать перезвоны.
- Не терять контроль по задаткам и оплатам.
- Не пропускать мероприятия.
- Упростить подготовку документов (договор/счет/акт).
- Дать базовую интеграцию входящих заявок с сайта (API/Tilda).
- Подготовить полноценное мобильное приложение (React Native + Expo) для надежных уведомлений и мобильных сценариев.
- Реализовать offline-first: создание/редактирование данных без интернета с последующей синхронизацией на сервер.

---

## KPI запуска (контроль результата)
- Доля заявок с хотя бы одним запланированным `additionalEvents` > 90%.
- Доля просроченных доп. событий (без переноса/закрытия) < 15%.
- Доля мероприятий с задатком до даты события > 80%.
- Доля пропущенных мероприятий ~= 0%.
- Конверсия `заявка -> подтверждено` и `подтверждено -> проведено` растет.

---

## Прогресс по спринтам

### Sprint 1: ядро контроля заявок и задатков (16.02.2026 - 01.03.2026)
- [x] E1-T1 Доп. события в мероприятии (`additionalEvents[]`: title, description, date)
- [x] E1-T2 Синхронизация доп. событий в Google Calendar (create/update/delete + связь по `googleCalendarEventId`)
- [x] E1-T3 Быстрые действия по доп. событиям в карточке (`+1 день`, `+3 дня`, `Сейчас`, `Встреча`)
- [x] E1-T4 Виджет `Просрочено / Сегодня / Завтра`
- [ ] E1-T5 Напоминания артисту по доп. событиям
- [ ] E1-T6 Финансовый статус задатка (`none|partial|received`, `depositAmount`, `depositDueAt`)
- [ ] E1-T7 Категории транзакций (`deposit`, `final_payment`, `taxes`, `referral_out`, `referral_in`)
- [ ] E1-T8 Напоминание `Скоро мероприятие, задатка нет`

### Sprint 2: документы и входящие интеграции (02.03.2026 - 15.03.2026)
- [ ] E2-T1 Шаблон стандартного договора с автоподстановкой
- [ ] E2-T2 Реквизиты клиента для договорных событий
- [ ] E2-T3 Чеклист подготовки события (`contract_prepared`, `invoice_sent`, `deposit_received`, `details_confirmed`)
- [ ] E2-T4 Public API для входящих заявок (`POST /api/public/lead`)
- [ ] E2-T5 Tilda webhook-адаптер (`POST /api/public/lead/tilda`)
- [ ] E2-T6 История коммуникаций и напоминаний по заявке/мероприятию

### Sprint 3: стабилизация, запуск, аналитика (16.03.2026 - 12.04.2026)
- [ ] E3-T1 Финальная полировка мобильного UX (phone-first)
- [ ] E3-T2 Отчеты по маржинальности мероприятий (налоги/комиссии)
- [ ] E3-T3 Обновление документации API для пользователей сервиса
- [ ] E3-T4 Подготовка релиза и onboarding для первых пользователей
- [ ] E3-T5 Offline-first для web/PWA: локальное сохранение заявок и синхронизация при восстановлении сети
- [ ] E3-T6 Обучение новых пользователей по работе с кабинетом (интерактивный гайд + чеклист старта)
- [ ] E3-T7 AI-черновик мероприятия по голосу (speech-to-text + автозаполнение формы события)

### Mobile Track (React Native + Expo, параллельный поток)
- [-] M1-T1 Архитектурный дизайн mobile-приложения (auth, API слой, навигация, offline стратегия)
- [ ] M1-T2 Bootstrap Expo-проекта и базовая авторизация
- [ ] M1-T3 Экран `Задачи контактов` (просрочено/сегодня/завтра) с быстрыми действиями
- [ ] M1-T4 Push-уведомления (Expo Notifications) для контактов/задатков/сроков
- [ ] M1-T5 Глубокие ссылки из уведомлений в карточку заявки/мероприятия
- [ ] M1-T6 Home Screen widgets (iOS/Android, где поддерживается) для срочных задач
- [ ] M1-T7 Call intents: быстрый запуск звонка и лог результата звонка в CRM
- [ ] M1-T8 Beta релиз (TestFlight/Android Internal Testing) и сбор обратной связи
- [ ] M1-T9 Offline outbox: локальное создание/редактирование заявок без сети + авто-синхронизация

---

## Backlog (приоритизация Impact/Effort)

### P0
- [ ] Просроченные доп. события + быстрый перенос
- [ ] Напоминание `задаток не получен`
- [ ] Финансовые типы транзакций (задаток/налог/комиссии)
- [ ] Offline-first создание заявки без интернета (локально + sync при online)

### P1
- [ ] Мобильные быстрые действия по заявке
- [ ] Шаблон договора с автозаполнением
- [ ] Tilda/API входящие заявки
- [ ] React Native + Expo приложение (MVP)
- [ ] Обучающие материалы и сценарий первого входа для новых пользователей

### P2
- [ ] Расширенная финансовая аналитика

### P3
- [ ] AI-подсказки (после стабилизации core-flow)
- [ ] Голосовое создание мероприятия через AI (распознавание речи + структура в поля CRM)

---

## Выполнено (уже сделано в проекте)

### Phone Verification
- [x] TELEFONIP start/check flow для регистрации и восстановления
- [x] SMS fallback (`/api/phone/verify/sms/send`, `/api/phone/verify/sms/check`)
- [x] finalize endpoint (`/api/phone/verify/finalize`)
- [x] Проверка подтверждения телефона перед register/reset

### UX login/register/recovery
- [x] Улучшенный блок подтверждения телефона с понятным CTA
- [x] Кнопка `Позвонить` (`tel:`) для подтверждения
- [x] QR показывается только на tablet+; на телефонах не упоминается
- [x] Кнопка SMS появляется после 60 секунд
- [x] В модалку первого запуска (onboarding профиля) добавлен выбор темы (`Темная тема`)

### Главная страница
- [x] Добавлен логотип и кнопка входа в правом верхнем углу
- [x] Исправлено наложение карточек на широких экранах
- [x] Убран демонстрационный блок `Сегодня / 6 новых заявок`
- [x] Ссылки на `Политику` и `Соглашение` открываются в новом окне

### Мероприятия
- [x] Фильтры для `Предстоящих`: `Заявки`, `Активные`, `Отменены`
- [x] Фильтры для `Прошедших`: `Завершены`, `Закрыты`, `Отменены`
- [x] `Отменены` выключен по умолчанию
- [x] При клонировании: статус копии `active`, транзакции оригинала не переносятся
- [x] При изменении даты начала сохраняется длительность и сдвигается дата окончания
- [x] Исправлен `Invalid time value` при ручном вводе даты

---

## Технические требования (единые)
- Единый формат ошибок API: `{ success:false, error:{ code, type, message } }`.
- Mobile first для всех критичных сценариев.
- Безопасные логи (без персональных данных в открытом виде).
- Соответствие требованиям РФ по обработке персональных данных.
- Для критичных действий (создание/изменение заявки): отсутствие сети не должно приводить к потере данных.

---

## Следующие шаги (ближайшие)
1. Сделать E1-T5 (напоминания артисту по доп. событиям), чтобы не терять follow-up.
2. Подготовить правила напоминаний по времени (например: за 2 часа, за 1 день, после просрочки).
3. Затем закрыть E1-T6/E1-T7 (задатки и финансы) и только потом переходить к Sprint 2.
4. Параллельно запустить Mobile Track с M1-T1 и M1-T2, чтобы не откладывать push-уведомления и mobile-first сценарии.

---

## Журнал изменений плана
- 2026-02-13: создан единый roadmap/checklist файл с текущим состоянием и согласованным планом.
- 2026-02-13: добавлен отдельный трек разработки полноценного мобильного приложения (React Native + Expo).
- 2026-02-13: начат M1-T1, добавлен базовый `mobile/` scaffold и документ `docs/MOBILE_APP_ARCHITECTURE.md`.
- 2026-02-13: завершен E1-T1 — добавлены поля контроля контакта в модель, API и форму мероприятия.
- 2026-02-13: в onboarding первого запуска добавлен выбор темы и сохранение предпочтения пользователя.
- 2026-02-13: добавлена идея AI-функции голосового создания мероприятия в roadmap.
- 2026-02-14: E1-T2 реализован через `additionalEvents` + двусторонняя синхронизация с Google Calendar (create/update/delete, хранение `googleCalendarEventId`).
- 2026-02-14: завершен E1-T3 — в модалке мероприятия добавлены быстрые действия `Сейчас`, `+1 день`, `+3 дня`, `Встреча` для доп. событий.
- 2026-02-14: завершен E1-T4 — в списке предстоящих добавлен виджет `Просрочено / Сегодня / Завтра` и окно `Ближайшие события`.
- 2026-02-14: в окне `Ближайшие события` добавлены быстрые переносы доп. событий (`+1 день`, `+3 дня`, выбор даты и времени).
