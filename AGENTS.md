# AGENTS.md — руководство для Codex и других агентов

## Описание проекта
- ArtistCRM: CRM для соло-артистов (основной сегмент).
- Ключевая ценность: не терять заявки, не забывать перезвоны, контролировать задатки/оплаты и сроки мероприятий.

## Язык
- Используй в ответах русский язык.

## Главный рабочий план
- Файл: `docs/PRODUCT_ROADMAP_AND_CHECKLIST.md`.
- Это единый источник правды по roadmap, backlog и статусам выполнения.
- Перед началом крупных задач:
  - проверь релевантные пункты в этом файле;
  - если задача закрывает пункт плана, обнови чекбокс и кратко добавь запись в раздел `Выполнено` или `Журнал изменений плана`.
- Статусы в плане:
  - `[ ]` не начато
  - `[-]` в работе
  - `[x]` выполнено

## Структура проекта
- `/app`: исходные страницы
- `/app/api`: API
- `/components`: компоненты
- `/schemas`: схемы БД
- `/models`: модели БД
- `/layouts`: крупные компоненты, модальные окна, карточки, листы, контент
- `/svg`: svg-файлы
- `/state`: atom/selectors Jotai и хелперы загрузок
- `/server`: серверные компоненты/логика
- `/helpers`: вспомогательные функции
- `/docs`: документация и рабочие планы

## Текущие продуктовые приоритеты
- P0:
  - контроль следующего контакта по заявке (`nextContactAt` и просрочки);
  - контроль задатка и финансовых статусов;
  - напоминания артисту о важных действиях.
- P1:
  - документы (стандартный договор с автоподстановкой);
  - входящие лиды через API/Tilda.
- Mobile-first обязателен: основные действия должны быть удобны с телефона.

## Стиль кода
- Следуй текущему стилю и принятым правилам именования.
- Делай минимально достаточные изменения без лишних рефакторингов.
- Не ломай существующие рабочие сценарии без явной причины.

## Работа с компонентами
- Используй React-функциональные компоненты и Next.js.
- Применяй проп-тайпинг там, где это уже принято в контексте файла/модуля.
- Для кнопок и интерактивных элементов обеспечивай `cursor: pointer`.

## Работа с API и данными
- Для новых endpoint'ов придерживайся безопасного и единообразного JSON-формата ошибок.
- Не логируй секреты, токены и чувствительные персональные данные.
- Учитывай требования законодательства РФ по работе с персональными данными.

## Запреты для ИИ
- Запрещено создавать бинарные файлы (картинки, аудио и т.п.), если пользователь явно не запросил и это не согласовано.

## Практика обновления документации
- При заметных изменениях UX/API обновляй соответствующие документы в `/docs`.
- Если изменение относится к roadmap/backlog, синхронизируй `docs/PRODUCT_ROADMAP_AND_CHECKLIST.md` в этом же PR/коммите.

## Версионирование (обязательно)
- Если в рамках задачи закрыт любой пункт roadmap (`[x]`) в `docs/PRODUCT_ROADMAP_AND_CHECKLIST.md`, обязательно обнови версию приложения в `package.json` в этом же наборе изменений.
- По умолчанию используй patch-bump (например, `1.4.2 -> 1.4.3`), если пользователь явно не просил minor/major.

### SemVer правила
- `patch` (`X.Y.Z -> X.Y.(Z+1)`):
  - багфиксы, косметические UI/UX-правки, небольшие доработки без breaking changes.
- `minor` (`X.Y.Z -> X.(Y+1).0`):
  - новая функциональность с обратной совместимостью (новые экраны, виджеты, фильтры, интеграции без ломки текущих API/потоков).
- `major` (`X.Y.Z -> (X+1).0.0`):
  - любые несовместимые изменения (breaking changes): изменение контрактов API, обязательные миграции, удаление/ломка существующего поведения.

### Практика для roadmap
- Закрыт один обычный roadmap-пункт без breaking changes: `patch`.
- Закрыт крупный функциональный блок/эпик (несколько связанных задач с новой ценностью): `minor`.
- Есть breaking changes: `major`.
- Перед любым повышением `major` версии обязательно запросить подтверждение у пользователя и выполнить bump только после явного согласия.
